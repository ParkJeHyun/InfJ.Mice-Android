package kr.co.iekorea.mc;import java.util.ArrayList;import kr.co.iekorea.mc.adapter.ScheduleGalleryAdapter;import kr.co.iekorea.mc.adapter.ScheduleViewPagerAdapter;import kr.co.iekorea.mc.staticdata.StaticData;import kr.co.iekorea.mc.util.BaseInterface;import kr.co.iekorea.mc.util.CustomLog;import kr.co.iekorea.mc.util.ProcessManager;import kr.co.iekorea.mc.util.WeakAsyncTask;import kr.co.iekorea.mc.xml.MybriefDAO;import kr.co.iekorea.mc.xml.ScheduleDateDto;import android.app.Activity;import android.content.Intent;import android.os.Bundle;import android.support.v4.view.ViewPager;import android.support.v4.view.ViewPager.OnPageChangeListener;import android.view.View;import android.view.View.OnClickListener;import android.widget.AdapterView;import android.widget.AdapterView.OnItemSelectedListener;import android.widget.Gallery;import android.widget.ImageButton;import android.widget.LinearLayout;import android.widget.LinearLayout.LayoutParams;import android.widget.TextView;import android.widget.Toast;public class MyBriefcaseSchedule_Activity extends Activity implements		BaseInterface {	// Activity control.	private ProcessManager processManager;	// layout area	private ImageButton btn_back;	private LinearLayout layout_header;	private LinearLayout layout_progressbar;		// contents 	private LinearLayout layout_list_tap;	private Gallery gallery_date;	private ViewPager viewPager;	private ImageButton btn_add;	private ImageButton btn_delete;		// adapter	private ScheduleGalleryAdapter GAdapter;	private ScheduleViewPagerAdapter VAdapter;		// items	private ArrayList<ScheduleDateDto> scheduleDateList = new ArrayList<ScheduleDateDto>();// agenda session list		// 언어	private TextView total_title,text_wait;		@Override	protected void onCreate(Bundle savedInstanceState) {		// TODO Auto-generated method stub		super.onCreate(savedInstanceState);		this.initView();		if (StaticData.logined) {			this.getXmlResources();			this.modifyXmlResources();						new getSheduleList(MyBriefcaseSchedule_Activity.this).execute();		} else {			switch (StaticData.NOWLANGUAGE) {			case StaticData.KOREA:			Toast.makeText(getApplicationContext(),			R.string.please_retry_ko, Toast.LENGTH_SHORT).show();			break;			case StaticData.ENGLISH:			Toast.makeText(getApplicationContext(),			R.string.please_retry_en, Toast.LENGTH_SHORT).show();			break;			case StaticData.CHINA:			Toast.makeText(getApplicationContext(),			R.string.please_retry_cn, Toast.LENGTH_SHORT).show();			break;			}			Intent intent = new Intent(getApplicationContext(),Login_Activity.class);			startActivity(intent);			overridePendingTransition(android.R.anim.fade_in,android.R.anim.fade_out);			finish();		}	}		@Override	protected void onDestroy() {		super.onDestroy();		this.processManager.deleteActivity(this);	}		@Override	public void onBackPressed() {		if(VAdapter != null){			if(VAdapter.deletemode){				VAdapter.changeDeleteMode();			}else{				Intent intent = new Intent(getApplicationContext(), MyBriefcase_Activity.class);				startActivity(intent);				finish();			}		}else{			Intent intent = new Intent(getApplicationContext(), MyBriefcase_Activity.class);			startActivity(intent);			finish();							}	}		@Override	public void finish() {		super.finish();		overridePendingTransition(android.R.anim.fade_in, android.R.anim.fade_out);	}	@Override	public void initView() {		this.setContentView(R.layout.activity_mybriefcaseschedule);		this.processManager = ProcessManager.getInstance();		this.processManager.addActivity(this);	}	@Override	public void getXmlResources() {		this.btn_back = (ImageButton) this.findViewById(R.id.btn_back);		this.layout_header = (LinearLayout) this.findViewById(R.id.layout_header);		this.layout_progressbar = (LinearLayout) this.findViewById(R.id.layout_progressbar);				// contents		this.layout_list_tap = (LinearLayout) this.findViewById(R.id.layout_list_tap);		this.gallery_date = (Gallery) this.findViewById(R.id.gallery_date);		// next date set area		this.viewPager = (ViewPager) this.findViewById(R.id.list_viewpager);				// button 		this.btn_add = (ImageButton) this.findViewById(R.id.btn_add);		this.btn_delete = (ImageButton) this.findViewById(R.id.btn_delete);				// 언어		this.total_title = (TextView) this.findViewById(R.id.total_title);		this.text_wait = (TextView) this.findViewById(R.id.text_wait);	}	@Override	public void modifyXmlResources() {		LayoutParams param;        param = new LayoutParams(LayoutParams.MATCH_PARENT,StaticData.device_Height/10);        this.layout_header.setLayoutParams(param);        this.layout_list_tap.setLayoutParams(param);        // 언어 설정에 다른 화면 구성		switch (StaticData.NOWLANGUAGE) {		case StaticData.KOREA:			this.btn_back.setImageResource(R.drawable.b_back_kr);			this.total_title.setText(R.string.schedule_ko);			this.text_wait.setText(R.string.wait_ko);			this.btn_add.setImageResource(R.drawable.b2_registration_kr);			this.btn_delete.setImageResource(R.drawable.b_delete_kr);			break;		case StaticData.ENGLISH:			this.btn_back.setImageResource(R.drawable.b_back_en);			this.total_title.setText(R.string.schedule_en);			this.btn_add.setImageResource(R.drawable.b2_registration_en);			this.btn_delete.setImageResource(R.drawable.b_delete_en);			this.text_wait.setText(R.string.wait_en);			break;		case StaticData.CHINA:			this.btn_back.setImageResource(R.drawable.b_back_cn);			this.total_title.setText(R.string.schedule_cn);			this.btn_add.setImageResource(R.drawable.b2_registration_cn);			this.btn_delete.setImageResource(R.drawable.b_delete_cn);			this.text_wait.setText(R.string.wait_cn);			break;		}	}	@Override	public void setEventListener() {		this.btn_back.setOnClickListener(new OnClickListener() {			@Override			public void onClick(View v) {				if(VAdapter != null){					if(VAdapter.deletemode){						VAdapter.changeDeleteMode();					}else{						Intent intent = new Intent(getApplicationContext(), MyBriefcase_Activity.class);						startActivity(intent);						finish();					}				}else{					Intent intent = new Intent(getApplicationContext(), MyBriefcase_Activity.class);					startActivity(intent);					finish();									}			}		});				this.btn_add.setOnClickListener(new OnClickListener() {			@Override			public void onClick(View v) {				Intent intent = new Intent(getApplicationContext(), MyBriefcaseScheduleAdd_Activity.class);				startActivity(intent);				finish();			}		});		this.btn_delete.setOnClickListener(new OnClickListener() {			@Override			public void onClick(View v) {				CustomLog.e("", "onclick delete");				if(VAdapter != null){					VAdapter.changeDeleteMode();				}			}		});	}		public boolean setAgendaAdapter(){		boolean result = false;				// step1 -> view pager adapter setting in here area		this.GAdapter = new ScheduleGalleryAdapter(this,scheduleDateList);		this.VAdapter = new ScheduleViewPagerAdapter(this, scheduleDateList, this);				this.gallery_date.setAdapter(GAdapter);		this.viewPager.setAdapter(VAdapter);				this.viewPager.setOnPageChangeListener(new OnPageChangeListener() {			@Override			public void onPageSelected(int position) {				gallery_date.setSelection(position);			}			@Override			public void onPageScrolled(int arg0, float arg1, int arg2) {			}			@Override			public void onPageScrollStateChanged(int value_x) {			}		});				this.gallery_date.setOnItemSelectedListener(new OnItemSelectedListener() {			@Override			public void onItemSelected(AdapterView<?> parent, View view,					int position, long id) {				viewPager.setCurrentItem(position, true);			}			@Override			public void onNothingSelected(AdapterView<?> parent) {			}		});				return result;	}		// ------------------------- back ground thread area -----------------------------------------	/** 	 * get getAgendaList AsnycTask	 * 일정의 총 세션 리스트를 가져온다.	 * */	class getSheduleList extends WeakAsyncTask<Void,Void,Void,Activity>	{			public getSheduleList(Activity target) {			super(target);			// TODO Auto-generated constructor stub		}		boolean result = false;		boolean check = false;		int count = 0;				@Override		protected void onPreExecute(Activity target)		{			layout_progressbar.setVisibility(LinearLayout.VISIBLE);		}				@Override		protected Void doInBackground(Activity target, Void... params) {			try			{				MybriefDAO dao = new MybriefDAO(MyBriefcaseSchedule_Activity.this);				if(scheduleDateList != null){					scheduleDateList.clear();				}								check = dao.setScheduleList();				if(check){					scheduleDateList = dao.getScheduleList();					if(scheduleDateList != null){						result = true;					}				}			}			catch(Exception e) {				result = false;				e.printStackTrace();			}			return null;		}				@Override		protected void onPostExecute(Activity target,Void param)		{			if(result){					// start next background				setAgendaAdapter();			}else{				switch (StaticData.NOWLANGUAGE) {				case StaticData.KOREA:				Toast.makeText(getApplicationContext(),				R.string.please_retry_ko, Toast.LENGTH_SHORT).show();				break;				case StaticData.ENGLISH:				Toast.makeText(getApplicationContext(),				R.string.please_retry_en, Toast.LENGTH_SHORT).show();				break;				case StaticData.CHINA:				Toast.makeText(getApplicationContext(),				R.string.please_retry_cn, Toast.LENGTH_SHORT).show();				break;				}				// 다시 접속하는 AsnycTask 실행 area			}			setEventListener();			layout_progressbar.setVisibility(LinearLayout.GONE);					}	}}