package kr.co.iekorea.mc.dialog;import kr.co.iekorea.mc.R;import kr.co.iekorea.mc.Survey_Activity;import kr.co.iekorea.mc.staticdata.StaticData;import kr.co.iekorea.mc.util.WeakAsyncTask;import kr.co.iekorea.mc.xml.SurveyDAO;import android.app.Activity;import android.app.Dialog;import android.content.Context;import android.content.Intent;import android.view.LayoutInflater;import android.view.View;import android.view.Window;import android.widget.EditText;import android.widget.ImageButton;import android.widget.LinearLayout;import android.widget.TextView;import android.widget.Toast;/** 요일 선택 다이얼 로그 */public class addSurveyTitleDialog extends Dialog implements android.view.View.OnClickListener{	public Activity activity;	public Context ctx;	private LinearLayout rootView_Layout,layout_total;		public EditText edit_survey_title;	public ImageButton btn_ok, btn_cancel;	public TextView text_contents;	/** 생성자 */	public addSurveyTitleDialog(Context context,Activity activity) {		super(context);		this.ctx = context;		this.activity = activity;		init();	}		public void init(){		this.requestWindowFeature(Window.FEATURE_NO_TITLE);		LayoutInflater layInf = (LayoutInflater)ctx.getSystemService(Context.LAYOUT_INFLATER_SERVICE);		rootView_Layout= (LinearLayout)layInf.inflate(R.layout.dialog_survey_edittext, null);		btn_cancel = (ImageButton) rootView_Layout.findViewById(R.id.btn_cancel);		btn_ok = (ImageButton) rootView_Layout.findViewById(R.id.btn_ok);		edit_survey_title = (EditText) rootView_Layout.findViewById(R.id.edit_survey_title);		text_contents = (TextView) rootView_Layout.findViewById(R.id.text_contents);		        // 언어 설정에 다른 화면 구성		switch (StaticData.NOWLANGUAGE) {		case StaticData.KOREA:			this.text_contents.setText(R.string.make_survey_ko);			this.btn_ok.setImageResource(R.drawable.b2_confirm_kr);			this.btn_cancel.setImageResource(R.drawable.b2_cancel_kr);			this.edit_survey_title.setHint(R.string.please_enter_the_title_ko);			break;		case StaticData.ENGLISH:			this.text_contents.setText(R.string.make_survey_en);			this.btn_ok.setImageResource(R.drawable.b2_confirm_en);			this.btn_cancel.setImageResource(R.drawable.b2_cancel_en);			this.edit_survey_title.setHint(R.string.please_enter_the_title_en);			break;		case StaticData.CHINA:			this.text_contents.setText(R.string.make_survey_cn);			this.btn_ok.setImageResource(R.drawable.b2_confirm_cn);			this.btn_cancel.setImageResource(R.drawable.b2_cancel_cn);			this.edit_survey_title.setHint(R.string.please_enter_the_title_cn);			break;		}						btn_ok.setOnClickListener(this);		btn_cancel.setOnClickListener(this);				setContentView(rootView_Layout, 				new LinearLayout.LayoutParams(						LinearLayout.LayoutParams.WRAP_CONTENT, 						LinearLayout.LayoutParams.WRAP_CONTENT));	}	@Override	public void onClick(View v) {		switch(v.getId()){		case R.id.btn_ok:			if(activity != null){				if(edit_survey_title.getText().toString().equals("")){					switch (StaticData.NOWLANGUAGE) {					case StaticData.KOREA:					Toast.makeText(ctx,					R.string.please_enter_the_title_ko, Toast.LENGTH_SHORT).show();					break;					case StaticData.ENGLISH:						Toast.makeText(ctx,					R.string.please_enter_the_title_en, Toast.LENGTH_SHORT).show();					break;					case StaticData.CHINA:						Toast.makeText(ctx,					R.string.please_enter_the_title_cn, Toast.LENGTH_SHORT).show();					break;					}				}else{					new addSurveyItem(activity).execute();					dismiss();				}			}else{				dismiss();			}			break;		case R.id.btn_cancel:			dismiss();			break;		}	}			// back ground	class addSurveyItem extends WeakAsyncTask<Void, Void, Void, Activity>{		boolean result = false;		public addSurveyItem(Activity target) {			super(target);		}				@Override		protected void onPreExecute(Activity target) {			addSurveyTitleDialog.this.dismiss();			((Survey_Activity)activity).layout_progressbar.setVisibility(LinearLayout.VISIBLE);		}		@Override		protected Void doInBackground(Activity target, Void... params) {			SurveyDAO dao = new SurveyDAO(activity);			try {				result = dao.addSurveyItem(edit_survey_title.getText().toString());			} catch (Exception e) {				result = false;			}						return null;		}				@Override		protected void onPostExecute(Activity target, Void result) {			((Survey_Activity)activity).layout_progressbar.setVisibility(LinearLayout.GONE);			if(this.result){				switch (StaticData.NOWLANGUAGE) {				case StaticData.KOREA:				Toast.makeText(ctx,				R.string.success_ko, Toast.LENGTH_SHORT).show();				break;				case StaticData.ENGLISH:					Toast.makeText(ctx,				R.string.success_en, Toast.LENGTH_SHORT).show();				break;				case StaticData.CHINA:					Toast.makeText(ctx,				R.string.success_cn, Toast.LENGTH_SHORT).show();				break;				}				Intent intent = new Intent(ctx, Survey_Activity.class);				activity.startActivity(intent);				activity.finish();			}else{				switch (StaticData.NOWLANGUAGE) {				case StaticData.KOREA:				Toast.makeText(ctx,				R.string.please_retry_ko, Toast.LENGTH_SHORT).show();				break;				case StaticData.ENGLISH:					Toast.makeText(ctx,				R.string.please_retry_en, Toast.LENGTH_SHORT).show();				break;				case StaticData.CHINA:					Toast.makeText(ctx,				R.string.please_retry_cn, Toast.LENGTH_SHORT).show();				break;				}			}			// dismiss dialog		}	}}